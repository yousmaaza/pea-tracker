# PEA Tracker - Suivi Intelligent de Portefeuille

## Vue d'ensemble du projet

PEA Tracker est une plateforme intelligente de gestion de portefeuille PEA (Plan d'√âpargne en Actions) utilisant des agents IA autonomes Claude pour optimiser les d√©cisions d'investissement. Le syst√®me automatise la surveillance des march√©s et l'analyse de portefeuille pour aider les investisseurs particuliers √† prendre des d√©cisions √©clair√©es sur les titres √©ligibles PEA.

## Vision

Cr√©er une solution l√©g√®re et intelligente bas√©e sur le **Model Context Protocol (MCP)** et **Claude Code**, minimisant la complexit√© technique tout en offrant des analyses financi√®res avanc√©es gr√¢ce √† l'IA.

## Objectifs principaux

- **Automatiser** la surveillance des march√©s financiers europ√©ens
- **Analyser** automatiquement les positions du portefeuille
- **Alerter** sur les opportunit√©s d'achat/vente avec scoring de fiabilit√©
- **Recommander** des ajustements strat√©giques bas√©s sur l'historique
- **Rapporter** mensuellement sur la performance et l'allocation

## Utilisateur cible

Investisseur particulier d√©tenteur d'un PEA souhaitant optimiser sa gestion de portefeuille gr√¢ce √† l'intelligence artificielle, sans avoir besoin de surveiller constamment les march√©s.

## P√©rim√®tre g√©ographique

Le syst√®me couvre les march√©s europ√©ens √©ligibles au PEA :
- France (Euronext Paris)
- Allemagne (Xetra)
- Italie (Borsa Italiana)
- Espagne (BME)
- Pays-Bas (Euronext Amsterdam)
- Belgique (Euronext Brussels)
- Portugal (Euronext Lisbon)
- ETF √©ligibles PEA (structure europ√©enne)

## Architecture technique

### Philosophie

Architecture **MCP-native** utilisant Claude Code comme environnement d'ex√©cution. Les agents Claude acc√®dent directement aux sources de donn√©es via des serveurs MCP standardis√©s, √©liminant compl√®tement le besoin d'infrastructure interm√©diaire (n8n, serveurs, etc.).

### Flux de donn√©es simplifi√©

```
Boursorama ‚Üí Export Excel ‚Üí Google Drive ‚Üê‚Üí Claude Agent (MCP) ‚Üí Gmail
```

### Stack technique actuelle

**Environnement d'ex√©cution**
- **Claude Code** : CLI tool pour ex√©cuter les agents IA
- **Agents personnalis√©s** : D√©finis dans `.claude/agents/`
- **Ex√©cution** : Manuelle via CLI ou automatis√©e via cron/scheduler syst√®me

**Serveurs MCP configur√©s**
- `@modelcontextprotocol/server-google-drive` : Acc√®s Google Drive/Sheets
- `@modelcontextprotocol/server-gmail` : Envoi d'emails
- `mcp-server-yfinance` : Donn√©es boursi√®res Yahoo Finance (temps r√©el)
- `@modelcontextprotocol/server-github` : Gestion du code source
- `@modelcontextprotocol/server-filesystem` : Acc√®s au syst√®me de fichiers local

**Stockage et donn√©es**
- Google Drive : Stockage des exports Boursorama, historiques et rapports
- Structure de dossiers Google Drive :
    ```
    PEA-Tracker/
    ‚îú‚îÄ‚îÄ Imports/                           # Boursorama exports (transaction history)
    ‚îÇ   ‚îî‚îÄ‚îÄ export-positions-comptables-DD-MM-YYYY_HH-MM-SS.csv
    ‚îú‚îÄ‚îÄ Reports/                           # Reports generated by agents
    ‚îÇ   ‚îú‚îÄ‚îÄ monthly/                      # Monthly Portfolio Advisor reports
    ‚îÇ   ‚îî‚îÄ‚îÄ signals/                      # Market Watcher alerts
    ‚îÇ       ‚îî‚îÄ‚îÄ signal_TICKER_YYYYMMDD_HHMM.md
    ‚îî‚îÄ‚îÄ PEA_Watchlist_Indicateurs.xlsx    # Main watchlist with technical indicators
    ```

**Donn√©es financi√®res**
- Yahoo Finance via MCP : Donn√©es boursi√®res en temps r√©el (gratuit)
- Indicateurs techniques calcul√©s par l'agent (RSI, MACD, MA)

**Notifications**
- Gmail via MCP : Envoi automatique des alertes et rapports

### Documentation technique

- Architecture MCP : [docs/architecture/mcp-integration.md](docs/architecture/mcp-integration.md)
- Yahoo Finance MCP : [docs/mcp/yahoo-finance-integration.md](docs/mcp/yahoo-finance-integration.md)

## Les agents IA

### Agent 1 : Market Watcher PEA ‚úÖ IMPL√âMENT√â

**Fichier** : `.claude/agents/market-watcher-pea.md`

**Mission** : Surveillance quotidienne des march√©s et g√©n√©ration d'alertes d'opportunit√©s (achat/vente) sur les titres √©ligibles PEA.

**Responsabilit√©s** :
- R√©cup√©rer la watchlist depuis Google Drive (`PEA_Watchlist_Indicateurs.xlsx`)
- Collecter les donn√©es de march√© via Yahoo Finance MCP
- Calculer les indicateurs techniques (RSI, MACD, MA20/50/200)
- D√©tecter les signaux d'achat/vente/surveillance
- Scorer la fiabilit√© de chaque signal (0-100)
- G√©n√©rer des rapports Markdown d√©taill√©s
- Sauvegarder les rapports dans Google Drive
- Envoyer des alertes par email (score ‚â• 60)

**Workflow complet** :
1. R√©cup√©ration du fichier Excel depuis Google Drive
2. Parsing des feuilles "Watchlist", "Indicateurs", "Positions"
3. Collecte des donn√©es de march√© (prix, volume, historique)
4. Calcul des indicateurs techniques pour chaque ticker actif
5. G√©n√©ration des signaux avec scoring de confiance
6. Mise √† jour du fichier Excel avec nouveaux indicateurs
7. Cr√©ation de rapports Markdown pour signaux ‚â• 60
8. Upload des rapports dans Google Drive
9. Envoi d'emails d'alerte via Gmail

**Indicateurs techniques** :
- RSI (14 p√©riodes) : D√©tection de surachat/survente
- MACD (12, 26, 9) : Identification des tendances
- Moyennes mobiles (MA20, MA50, MA200) : Support/r√©sistance
- Volume ratio : Confirmation des mouvements

**Signaux g√©n√©r√©s** :
- üü¢ **BUY** : RSI < 30, volume √©lev√©, MACD haussier, prix > MA200
- üî¥ **SELL** : RSI > 70, divergence RSI, MACD baissier, cassure MA200
- üü° **WATCH** : RSI 30-40 ou 60-70, consolidation, signaux mixtes

**Fr√©quence recommand√©e** : Quotidienne √† 8h (avant ouverture des march√©s)

**Invocation** :
```bash
# Via Claude Code
claude-code agent run market-watcher-pea

# Ou en mode interactif
claude-code
> invoke @market-watcher-pea
```

**Sp√©cifications compl√®tes** : [docs/agents/market-watcher-spec.md](docs/agents/market-watcher-spec.md)

### Agent 2 : Portfolio Advisor üîú √Ä D√âVELOPPER

**Mission** : Analyse mensuelle du portefeuille, suivi de la performance et recommandations strat√©giques.

**Responsabilit√©s pr√©vues** :
- Calculer la performance globale et par ligne
- Analyser l'allocation sectorielle et g√©ographique
- √âvaluer le niveau de diversification
- G√©n√©rer des rapports mensuels d√©taill√©s
- Proposer des recommandations de r√©√©quilibrage
- Suivre les objectifs d'investissement

**Fr√©quence recommand√©e** : Mensuelle (1er du mois) + √† la demande

**Statut** : Sp√©cifications d√©finies, impl√©mentation √† venir

**Sp√©cifications compl√®tes** : [docs/agents/portfolio-advisor-spec.md](docs/agents/portfolio-advisor-spec.md)

## Structure du projet

```
claude-project/
‚îú‚îÄ‚îÄ .claude/
‚îÇ   ‚îú‚îÄ‚îÄ agents/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ market-watcher-pea.md         # ‚úÖ Agent Market Watcher impl√©ment√©
‚îÇ   ‚îî‚îÄ‚îÄ settings.local.json                # Configuration MCP locale
‚îÇ
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ agents/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ market-watcher-spec.md         # Sp√©cifications Market Watcher
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ portfolio-advisor-spec.md      # Sp√©cifications Portfolio Advisor
‚îÇ   ‚îú‚îÄ‚îÄ architecture/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ mcp-integration.md             # Documentation architecture MCP
‚îÇ   ‚îú‚îÄ‚îÄ mcp/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ yahoo-finance-integration.md   # Guide Yahoo Finance MCP
‚îÇ   ‚îú‚îÄ‚îÄ ARCHITECTURE_DECISION.md           # D√©cisions architecture (n8n ‚Üí MCP)
‚îÇ   ‚îî‚îÄ‚îÄ SETUP_GUIDE.md                     # Guide d'installation
‚îÇ
‚îú‚îÄ‚îÄ prompts/
‚îÇ   ‚îú‚îÄ‚îÄ market-analysis.md                 # Prompt template Market Watcher
‚îÇ   ‚îú‚îÄ‚îÄ portfolio-review.md                # Prompt template Portfolio Advisor
‚îÇ   ‚îî‚îÄ‚îÄ prompt/                            # Anciens prompts de test
‚îÇ
‚îú‚îÄ‚îÄ scripts/                               # (Vide - plus n√©cessaire avec MCP)
‚îÇ
‚îú‚îÄ‚îÄ CLAUDE.md                              # üìÑ Ce fichier
‚îú‚îÄ‚îÄ README.md                              # Documentation utilisateur
‚îî‚îÄ‚îÄ TODO.md                                # Liste des t√¢ches √† venir
```

## Pr√©requis et configuration

### Pr√©requis

| √âl√©ment | Description | Co√ªt |
|---------|-------------|------|
| Claude Code | CLI tool Anthropic | Gratuit |
| Cl√© API Claude | API Anthropic | 5-20‚Ç¨/mois |
| Google Workspace | Drive + Gmail | Gratuit |
| MCP Servers | Serveurs MCP standards | Gratuit |
| Yahoo Finance | Via MCP | Gratuit |

**Total estim√©** : **5-20‚Ç¨/mois** (uniquement l'API Claude)

### Installation

1. **Installer Claude Code** :
```bash
npm install -g @anthropic-ai/claude-code
```

2. **Configurer l'API Claude** :
```bash
export ANTHROPIC_API_KEY="your-api-key"
```

3. **Configurer les serveurs MCP** :
   - √âditer `.claude/settings.local.json`
   - Ajouter les serveurs n√©cessaires (Google Drive, Gmail, Yahoo Finance)

4. **Configurer Google Drive** :
   - Cr√©er la structure de dossiers `PEA-Tracker/`
   - Cr√©er le fichier `PEA_Watchlist_Indicateurs.xlsx`
   - Configurer les authentifications OAuth

5. **Configuration Gmail** :
   - G√©n√©rer un mot de passe d'application
   - Configurer le serveur MCP Gmail

### Documentation d'installation compl√®te

Voir [docs/SETUP_GUIDE.md](docs/SETUP_GUIDE.md)

## Utilisation

### 1. Market Watcher - Surveillance quotidienne

**Lancement manuel** :
```bash
claude-code agent run market-watcher-pea
```

**Automatisation via cron** (recommand√©) :
```bash
# √âditer crontab
crontab -e

# Ajouter cette ligne pour ex√©cution quotidienne √† 8h
0 8 * * 1-5 cd /path/to/claude-project && claude-code agent run market-watcher-pea
```

**Ce que fait l'agent** :
1. ‚úÖ R√©cup√®re la watchlist depuis Google Drive
2. ‚úÖ Analyse les titres actifs
3. ‚úÖ Calcule les indicateurs techniques
4. ‚úÖ G√©n√®re les signaux d'achat/vente
5. ‚úÖ Sauvegarde les rapports dans Google Drive
6. ‚úÖ Envoie les alertes par email (score ‚â• 60)

### 2. Portfolio Advisor - Analyse mensuelle (√† venir)

**Pr√©vu** : Analyse automatique le 1er de chaque mois

### 3. Export Boursorama

**Proc√©dure** :
1. Se connecter √† Boursorama
2. PEA ‚Üí T√©l√©charger les positions comptables (format CSV)
3. Uploader le fichier dans Google Drive/PEA-Tracker/Imports/
4. L'agent Portfolio Advisor utilisera ces donn√©es pour l'analyse

## Avantages de l'architecture MCP

### ‚úÖ Simplicit√©
- Pas de serveur √† maintenir
- Pas de base de donn√©es √† g√©rer
- Pas d'orchestrateur complexe (n8n)
- Configuration minimale

### ‚úÖ Co√ªts r√©duits
- Infrastructure : 0‚Ç¨ (pas de serveur)
- API Claude : 5-20‚Ç¨/mois uniquement
- Total : **5-20‚Ç¨/mois** (vs 25-60‚Ç¨/mois avec n8n)

### ‚úÖ Fiabilit√©
- Moins de points de d√©faillance
- Agents autonomes et r√©silients
- Gestion d'erreurs int√©gr√©e

### ‚úÖ √âvolutivit√©
- Ajout facile de nouveaux serveurs MCP
- Cr√©ation simple de nouveaux agents
- R√©utilisation de serveurs MCP standards

## S√©curit√©

- ‚úÖ Cl√©s API stock√©es dans variables d'environnement
- ‚úÖ Authentification OAuth pour Google services
- ‚úÖ Pas de stockage d'identifiants broker
- ‚úÖ Acc√®s restreint aux dossiers Google Drive
- ‚úÖ Communications chiffr√©es (HTTPS)
- ‚ö†Ô∏è Ne jamais commiter les fichiers de configuration avec secrets

## Roadmap

### Phase 1 : Infrastructure MCP ‚úÖ TERMIN√âE
- [x] Configuration Claude Code
- [x] Installation serveurs MCP
- [x] Authentification Google Drive/Gmail
- [x] Structure Google Drive cr√©√©e
- [x] Agent Market Watcher impl√©ment√©

### Phase 2 : Portfolio Advisor üîÑ EN COURS
- [ ] Impl√©menter l'agent Portfolio Advisor
- [ ] Parser les exports Boursorama (CSV)
- [ ] Calculer les m√©triques de performance
- [ ] G√©n√©rer les rapports mensuels
- [ ] Automatiser l'envoi des rapports

### Phase 3 : Optimisations üìã PLANIFI√âE
- [ ] Backtesting des signaux Market Watcher
- [ ] Profil de risque personnalis√©
- [ ] Int√©gration actualit√©s financi√®res (RSS/API)
- [ ] Dashboard web simple (optionnel)
- [ ] Alertes Telegram/SMS (optionnel)

### Phase 4 : Am√©liorations avanc√©es üîÆ FUTUR
- [ ] Machine Learning pour scoring am√©lior√©
- [ ] Analyse sentiment market (NLP)
- [ ] Int√©gration donn√©es fondamentales
- [ ] Support multi-portefeuilles

## Points d'attention
- Si besoin d'utiliser du python il faudra s'assurer que le profile d'environnement

## Workflow de d√©veloppement et gestion Git

### Commits et push r√©guliers

**‚ö†Ô∏è R√àGLE IMPORTANTE** : Toute modification significative du code ou de la documentation doit √™tre commit√©e et push√©e imm√©diatement.

**Quand commiter et pusher** :
- ‚úÖ **Apr√®s chaque modification fonctionnelle** (ajout de feature, correction de bug, refactoring)
- ‚úÖ **Apr√®s mise √† jour de documentation** (README, CLAUDE.md, fichiers docs/)
- ‚úÖ **Apr√®s modification de configuration** (MCP, agents, settings)
- ‚úÖ **Apr√®s cr√©ation/modification de fichiers** importants
- ‚úÖ **√Ä la fin de chaque t√¢che compl√©t√©e** dans la todo list
- ‚ùå **Pas de commit** pour les fichiers temporaires ou tests locaux

**Bonnes pratiques de commit** :
1. **Messages clairs et descriptifs** en fran√ßais :
   ```bash
   # Format recommand√©
   git commit -m "feat: ajout calcul RSI dans Market Watcher"
   git commit -m "fix: correction parsing Excel watchlist"
   git commit -m "docs: mise √† jour CLAUDE.md avec workflow Git"
   git commit -m "refactor: simplification logique scoring signaux"
   ```

2. **Pr√©fixes de commit** (convention) :
   - `feat:` - Nouvelle fonctionnalit√©
   - `fix:` - Correction de bug
   - `docs:` - Documentation uniquement
   - `refactor:` - Refactoring sans changement de fonctionnalit√©
   - `test:` - Ajout ou modification de tests
   - `chore:` - Maintenance (d√©pendances, config, etc.)
   - `perf:` - Am√©lioration de performance

3. **Commits atomiques** :
   - Un commit = une modification logique
   - Ne pas m√©langer plusieurs changements non li√©s
   - Facilite le review et le rollback si n√©cessaire

**Workflow Git standard** :
```bash
# 1. V√©rifier l'√©tat actuel
git status

# 2. Ajouter les fichiers modifi√©s
git add <fichiers>
# ou pour tout ajouter
git add .

# 3. Commiter avec message descriptif
git commit -m "feat: description claire de la modification"

# 4. Pusher vers la branche de d√©veloppement
git push -u origin claude/update-claude-workflow-9kjVv

# 5. En cas d'erreur r√©seau, retry avec backoff
# (automatique via les instructions Git Operations)
```

**Branche de d√©veloppement** :
- üîπ Branche actuelle : `claude/update-claude-workflow-9kjVv`
- üîπ Toujours d√©velopper sur cette branche
- üîπ JAMAIS pusher sur main/master sans permission explicite
- üîπ Cr√©er une PR pour merger vers main

**Gestion des erreurs Git** :
- Si `git push` √©choue avec erreur r√©seau ‚Üí retry jusqu'√† 4 fois (2s, 4s, 8s, 16s)
- Si erreur 403 ‚Üí v√©rifier que la branche commence par `claude/` et se termine par session ID
- Si conflit ‚Üí `git pull --rebase origin <branch>` puis r√©soudre et pusher

**Synchronisation** :
```bash
# R√©cup√©rer les derni√®res modifications
git fetch origin claude/update-claude-workflow-9kjVv
git pull origin claude/update-claude-workflow-9kjVv

# Ou en une commande
git pull --rebase origin claude/update-claude-workflow-9kjVv
```

**√Ä √âVITER** :
- ‚ùå Commiter des secrets ou cl√©s API (.env, credentials.json)
- ‚ùå Commiter des fichiers de config locaux (.claude/settings.local.json)
- ‚ùå Force push sur des branches partag√©es
- ‚ùå Amender des commits d√©j√† push√©s (sauf autorisation)
- ‚ùå Commits vagues type "mise √† jour" ou "fix"

**Utilisation du .gitignore** :
Le projet doit inclure un `.gitignore` avec :
```
.claude/settings.local.json
.env
*.pyc
__pycache__/
node_modules/
.DS_Store
credentials.json
token.json
```

### R√©glementaire
‚ö†Ô∏è **Important** : Ce syst√®me ne constitue pas du conseil en investissement au sens AMF. Tous les rapports et alertes incluent un disclaimer appropri√©. Les d√©cisions d'investissement restent sous la responsabilit√© de l'utilisateur.

### Limitations techniques
- D√©pendance aux APIs externes (Yahoo Finance, Google)
- Rate limiting possible sur les APIs gratuites
- Donn√©es de march√© avec l√©ger d√©lai (non temps r√©el strict)
- N√©cessite une connexion internet stable

### Bonnes pratiques
- Avant d'utiliser les agents tu peux creer un environnement virtuel python et utiliser la commande `/pip-mode standard` pour installer les d√©pendances python sans conflit.
- utilise du Python 3.11 ou sup√©rieur
- Toujours v√©rifier les signaux avant d'agir
- Utiliser les stop-loss recommand√©s
- Ne jamais investir plus que ce qu'on peut perdre
- Diversifier le portefeuille
- Suivre une strat√©gie d'investissement coh√©rente

## Support et ressources

### Documentation
- [Architecture MCP](docs/architecture/mcp-integration.md)
- [Guide d'installation](docs/SETUP_GUIDE.md)
- [Sp√©cifications agents](docs/agents/)

### Ressources externes
- [Claude Code Documentation](https://docs.anthropic.com/claude-code)
- [Model Context Protocol](https://modelcontextprotocol.io/)
- [Yahoo Finance API](https://www.yahoofinanceapi.com/)
- [√âligibilit√© PEA](https://www.service-public.fr/particuliers/vosdroits/F2385)

## Glossary

- **PEA** : Plan d'√âpargne en Actions - Enveloppe fiscale fran√ßaise
- **MCP** : Model Context Protocol - Standard pour connecter les LLM aux sources de donn√©es
- **RSI** : Relative Strength Index - Indicateur de momentum
- **MACD** : Moving Average Convergence Divergence - Indicateur de tendance
- **MA** : Moving Average - Moyenne mobile
- **Claude Code** : CLI tool pour ex√©cuter des agents Claude
- **Boursorama** : Courtier en ligne fran√ßais
- **ETF** : Exchange Traded Fund - Fonds n√©goci√© en bourse

## Disclaimer

‚ö†Ô∏è **AVERTISSEMENT IMPORTANT**

Ce projet est un **outil d'aide √† la d√©cision** utilisant l'analyse technique automatis√©e. Il **NE CONSTITUE EN AUCUN CAS UN CONSEIL EN INVESTISSEMENT** au sens de l'AMF (Autorit√© des March√©s Financiers).

**Responsabilit√©s** :
- Toutes les d√©cisions d'investissement restent sous votre **enti√®re responsabilit√©**
- Les performances pass√©es ne pr√©jugent **pas** des performances futures
- Les march√©s financiers comportent des **risques de perte en capital**
- Vous devez toujours effectuer vos **propres recherches**
- Consultez un conseiller financier agr√©√© si n√©cessaire

**Limites de l'outil** :
- Les analyses sont bas√©es uniquement sur des indicateurs techniques
- Les donn√©es peuvent contenir des erreurs ou retards
- L'IA peut g√©n√©rer des recommandations erron√©es
- Aucune garantie de rentabilit√© n'est fournie

**Utilisation √† vos risques et p√©rils.**

## Licence

[√Ä d√©finir selon vos besoins]

---

**Version** : 2.0.0
**Derni√®re mise √† jour** : 2026-01-07
**Statut** : Phase 1 termin√©e, Agent Market Watcher op√©rationnel
**Architecture** : MCP-native avec Claude Code

Cr√©√© avec ‚ù§Ô∏è et Claude Code
